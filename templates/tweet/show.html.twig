{% extends 'base.html.twig' %}

{% block title %}
	{{ app.user.username }}
	sur X:
																																				"{{ tweet.content }}"
{% endblock %}

{% block body %}
	<div class="flex justify-start items-center border-b border-gray-700">
		<a class="flex items-center gap-4 border border-blue-500 text-white px-5 py-2 ml-4 mb-4 rounded-full font-semibold cursor-pointer hover:bg-blue-500 transition" href="{{ path('app_tweet_index') }}">
			<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#ffffff" class="bi bi-arrow-left" viewbox="0 0 16 16">
				<path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
			</svg>
			<p>Retour</p>
		</a>
	</div>

	<div class="px-4 py-5 border-b border-gray-700 bg-[#000000]">
		<div class="flex gap-3">
			{% if tweet.user and tweet.user.avatar %}
				<img src="{{ asset('uploads/avatars/' ~ tweet.user.avatar) }}" alt="Avatar" class="w-10 h-10 rounded-full object-cover">
			{% else %}
				<img src="https://as2.ftcdn.net/v2/jpg/03/59/58/91/1000_F_359589186_JDLl8dIWoBNf1iqEkHxhUeeOulx0wOC5.jpg" alt="Avatar" class="w-10 h-10 rounded-full object-cover">
			{% endif %}
			<div class="flex-1">
				<div class="flex justify-between items-center gap-2">
					<div class="text-sm">
						<span class="font-bold text-white">{{ app.user.username }}</span>
						<span class="text-gray-400 text-xs">
							•
							{{ tweet.dateTweet ? tweet.dateTweet|date('d/m/y') : '' }}
						</span>
					</div>
					<div class="flex flex-row gap-4">
						{% if app.user and tweet.user == app.user %}
							<a href="{{ path('app_tweet_edit', {'id': tweet.id}) }}" class="text-gray-500 hover:underline">
								<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-pencil" viewbox="0 0 16 16">
									<path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"/>
								</svg>
							</a>
							{{ include('tweet/_delete_form.html.twig') }}
						{% endif %}
					</div>
				</div>
				<div class="mt-1 text-[15px] text-gray-100 break-all overflow-hidden">
					{{ tweet.content }}
				</div>
				<div class="flex justify-between items-center gap-4 border-y border-gray-700 py-2 mt-6">
					<div class="flex justify-center items-center gap-1">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#a8a8a8" class="bi bi-chat" viewbox="0 0 16 16">
							<path d="M2.678 11.894a1 1 0 0 1 .287.801 11 11 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8 8 0 0 0 8 14c3.996 0 7-2.807 7-6s-3.004-6-7-6-7 2.808-7 6c0 1.468.617 2.83 1.678 3.894m-.493 3.905a22 22 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a10 10 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9 9 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105"/>
						</svg>
						<span class="text-gray-500">{{ tweet.commentaires|length }}</span>
					</div>
					<div class="flex justify-center items-center cursor-pointer">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#a8a8a8" class="bi bi-arrow-down-up" viewbox="0 0 16 16">
							<path fill-rule="evenodd" d="M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5m-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5"/>
						</svg>
						<p class="text-gray-500 cursor-pointe ml-1">0</p>
					</div>
					<form action="{{ path('app_tweet_like', {'id': tweet.id}) }}" method="post" style="display:inline;">
						<button type="submit" class="flex items-center cursor-pointer text-gray-400 hover:text-pink-300">
							{% if tweet.isLikedBy(app.user) %}
								<svg xmlns="http://www.w3.org/2000/svg" fill="#f91880" viewbox="0 0 24 24" width="20" height="20" class="mr-1">
									<path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
								</svg>
							{% else %}
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="#a8a8a8" stroke-width="2" viewbox="0 0 24 24" width="20" height="20" class="mr-1">
									<path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
								</svg>
							{% endif %}
							<span>{{ tweet.likes|length }}</span>
						</button>
					</form>
				</div>
				<form class=" mt-3" action="{{ path('app_tweet_commentaire', {'id': tweet.id}) }}" method="post">
					<textarea class="text-white w-full min-h-[80px] focus:outline-none focus:ring-2 focus:ring-main-color resize-none p-3 border-b border-gray-400" name="content" rows="2" placeholder="Votre commentaire..." required></textarea>
					<div class="flex justify-end mt-2">
						<button type="submit" class="border border-blue-500 text-blue-400 px-4 py-1 rounded-full font-semibold cursor-pointer hover:bg-blue-500 hover:text-white transition">Commenter</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<div class="text-white">

		{% for commentaire in tweet.commentaires %}
			<div class="p-5 border-b border-gray-700 flex gap-3">
				{% if commentaire.user and commentaire.user.avatar %}
					<img src="{{ asset('uploads/avatars/' ~ commentaire.user.avatar) }}" alt="Avatar" class="w-10 h-10 rounded-full object-cover">
				{% else %}
					<img src="https://as2.ftcdn.net/v2/jpg/03/59/58/91/1000_F_359589186_JDLl8dIWoBNf1iqEkHxhUeeOulx0wOC5.jpg" alt="Avatar" class="w-10 h-10 rounded-full object-cover">
				{% endif %}
				<div class="flex-1">
					<div class="flex justify-between items-center gap-2">
						<div class="text-sm">
							<span class="font-bold text-white">{{ commentaire.user.username }}</span>
							<span class="text-gray-400 text-xs">
								•
								{{ commentaire.dateComment ? commentaire.dateComment| date("d/m/y H:i") : "" }}
							</span>
						</div>
						<div class="flex flex-row gap-4">
							{% if app.user and tweet.user == app.user %}
								<a href="{{ path('app_tweet_edit', {'id': tweet.id}) }}" class="text-gray-500 hover:underline">
									<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-pencil" viewbox="0 0 16 16">
										<path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"/>
									</svg>
								</a>
								{{ include('tweet/_delete_form.html.twig') }}
							{% endif %}
						</div>
					</div>
					<div class="mt-1 text-[15px] text-gray-100 break-all overflow-hidden">
						{{ commentaire.content }}
					</div>
					<form action="{{ path('app_commentaire_like', {'id': commentaire.id}) }}" method="post" style="display:inline;">
						<button type="submit" class="flex items-center text-gray-400 hover:text-pink-300">
							{% if commentaire.isLikedBy(app.user) %}
								<svg xmlns="http://www.w3.org/2000/svg" fill="#f91880" viewbox="0 0 24 24" width="20" height="20" class="mr-1">
									<path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
								</svg>
							{% else %}
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="#a8a8a8" stroke-width="2" viewbox="0 0 24 24" width="20" height="20" class="mr-1">
									<path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
								</svg>
							{% endif %}
							<span>{{ commentaire.likes|length }}</span>
						</button>
					</form>
				</div>
			</div>
		{% endfor %}

	</div>
{% endblock %}
